<app-layout>
  <div class="dashboard-container">
    
    <!-- Product Form Card -->
    <p-card [header]="isEditMode ? 'Edit Product' : 'Create Product'" styleClass="mb-4">
      <div class="form-grid">
        <div class="field">
          <label for="productName">Product Name</label>
          <input 
            pInputText 
            id="productName" 
            [(ngModel)]="selectedProduct.name" 
            placeholder="Enter product name"
            class="w-full" />
        </div>

        <div class="field">
          <label for="price">Price</label>
          <p-inputNumber
            id="price"
            [(ngModel)]="selectedProduct.price"
            placeholder="Enter price"
            class="w-full">
          </p-inputNumber>
        </div>

        <div class="field">
          <label for="dateOfManufacture">Date of Manufacture</label>
          <input 
            pInputText 
            id="dateOfManufacture" 
            type="date"
            [(ngModel)]="selectedProduct.dateOfManufacture" 
            class="w-full" />
        </div>

        <div class="field">
          <label for="dateOfExpiry">Date of Expiry</label>
          <input 
            pInputText 
            id="dateOfExpiry" 
            type="date"
            [(ngModel)]="selectedProduct.dateOfExpiry" 
            class="w-full" />
        </div>

        <div class="field flex gap-2 align-items-end">
          <p-button 
            [label]="isEditMode ? 'Update' : 'Create'" 
            icon="pi pi-check"
            (onClick)="saveProduct()"
            severity="success">
          </p-button>

          <p-button 
            *ngIf="isEditMode"
            label="Cancel" 
            icon="pi pi-times"
            (onClick)="resetForm()"
            severity="secondary">
          </p-button>
        </div>
      </div>
    </p-card>

    <!-- Products Table Card -->
    <p-card header="All Products">
      <p-table 
        [value]="products" 
        [paginator]="true" 
        [rows]="10"
        [tableStyle]="{ 'min-width': '50rem' }"
        [rowsPerPageOptions]="[5, 10, 20]"
        [showCurrentPageReport]="true"
        currentPageReportTemplate="Showing {first} to {last} of {totalRecords} products"
        styleClass="p-datatable-striped">
        
        <ng-template #header>
          <tr>
            <th pSortableColumn="id">ID <p-sortIcon field="id" /></th>
            <th pSortableColumn="name">Name <p-sortIcon field="name" /></th>
            <th pSortableColumn="price">Price <p-sortIcon field="price" /></th>
            <th pSortableColumn="dateOfManufacture">Date of Manufacture <p-sortIcon field="dateOfManufacture" /></th>
            <th pSortableColumn="dateOfExpiry">Date of Expiry <p-sortIcon field="dateOfExpiry" /></th>
            <th style="width: 200px">Actions</th>
          </tr>
        </ng-template>
        
        <ng-template #body let-product>
          <tr>
            <td>{{ product.id }}</td>
            <td>{{ product.name }}</td>
            <td>{{ product.price }}</td>
            <td>{{ product.dateOfManufacture }}</td>
            <td>{{ product.dateOfExpiry }}</td>
            <td>
              <div class="flex gap-2">
                <p-button  
                  icon="pi pi-pencil" 
                  [rounded]="true"
                  severity="info"
                  size="small"
                  (onClick)="editProduct(product)">
                </p-button>
                <p-button 
                  icon="pi pi-trash" 
                  [rounded]="true"
                  severity="danger"
                  size="small"
                  (onClick)="deleteProduct(product.id!)">
                </p-button>
              </div>
            </td>
          </tr>
        </ng-template>

        <ng-template #emptymessage>
          <tr>
            <td colspan="6" class="text-center">No products found.</td>
          </tr>
        </ng-template>
      </p-table>
    </p-card>

    <!-- Confirmation Dialog -->
    <p-confirmDialog />

  </div>
</app-layout>
